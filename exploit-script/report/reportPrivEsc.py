from utils.parsePrivEscLogFile import parsePrivEscLogFile

def reportPrivEsc(message):
  if type(message) == str:
    return f"## Privilege Escalation\n\n{message}\n"
  
  results = parsePrivEscLogFile()
  report = [ "## Privilege Escalation\n" ]
  
  if not results:
    report.append("All good.\n")
  else:
    for title in results:
      report.append(f"### {title}\n")
      for res in results[title]:
        if res["message"]:
          report.append(res["message"])
          report.append("")
        
        for script in res["scripts"]:
          s = "\n".join([ "$ " + line for line in script.split("\n") if line ])
          report.append(f"```bash")
          report.append(s)
          report.append("```\n")
    
  return "\n".join(report)
