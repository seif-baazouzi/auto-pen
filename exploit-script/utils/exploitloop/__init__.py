from .forms import exploitForms
from .urls import exploitPathParams, exploitQueryParams

###########################################################################
###########################################################################

class Result:
  def __init__(self, urlsResults, formsResults):
    self.urls = urlsResults
    self.forms = formsResults

  def __len__(self):
    return len(self.urls) + len(self.forms)

###########################################################################
###########################################################################

def exploitLoop(urls, forms, cookies, payloads, checkResponseFunction, foundExploitCallback):
  return Result(
    [
      *exploitPathParams(urls, cookies, payloads, checkResponseFunction, foundExploitCallback),
      *exploitQueryParams(urls, cookies, payloads, checkResponseFunction, foundExploitCallback)
    ],
    exploitForms(forms, cookies, payloads, checkResponseFunction, foundExploitCallback)
  )
