from .tools import testUrl, testForms
from log import impr, bold, red, warn, info

###########################################################################
###########################################################################

def sqliModule(urls, cookies):
  results = []
  
  info(bold("Testing urls for SQL Injection"))
  
  foundSQLi = False
  for url in urls:
    res = testUrl(url.sample(), cookies)
    if res != None:
      impr(f"The url {res.url} {bold(red('is vulnerable'))}\n{res.results}")
      results.append(res)
      foundSQLi = True

  if not foundSQLi:
    warn("No SQLi found")

  print()

  info(bold("Testing forms for SQL Injection"))
  
  foundSQLi = False
  for url in urls:
    res = testForms(url.sample(), cookies)
    if res != None:
      impr(f"The form in url {res.url} {bold(red('is vulnerable'))}\n{res.results}")
      results.append(res)
      foundSQLi = True
  
  if not foundSQLi:
    warn("No SQLi found")
  
  return results
