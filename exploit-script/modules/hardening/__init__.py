import json
import requests

from .tools import getTechnologiesKeywordsList

def hardeningModule(technologies):
  if len(technologies) == 0:
    return []

  technologiesNames = [ tech.name for tech in technologies ]
  query = ",".join(getTechnologiesKeywordsList(technologiesNames))
  
  try:
    res = requests.get(f"http://api.hardening.auto-pen.local:8080/technologies/{query}", headers={ "X-Apikey": "439b3f3b-860c-4048-b9b2-5965eed80bb3" })
    res = json.loads(res.text)

    if "data" in res:
      return res["data"]
    
    return []
  except:
    return []
