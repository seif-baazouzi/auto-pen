from log import info, bold, warn, item
from .tools import getCVSS

###########################################################################
###########################################################################

def addCVE(technologie, cvssList):
  cvss = getCVSS(technologie)
  if cvss != None:
    for cve in cvss:
      item(f"{cve.title} ({cve.url})")
      cvssList.append(cve)

###########################################################################
###########################################################################

def cvesModule(webtechTechnologies):
  results = []
  info(bold("Searching for CVSS"))
  
  for tec in webtechTechnologies:
    if tec.version != None:
      addCVE(tec, results)
  
  if len(results) == 0:
    warn("Did not find any cve")
    
  return results
