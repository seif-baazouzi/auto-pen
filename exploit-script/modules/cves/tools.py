import os
import json

###########################################################################
###########################################################################

class CVE:
  def __init__(self, title, url):
    self.title = title
    self.url = url

###########################################################################
###########################################################################

def getCVSS(technologie):
  results = []
  
  cvssJson = json.loads(
    os.popen(f"searchsploit -w -e -s --json -t {technologie}").read()
  )

  cvssList = cvssJson["RESULTS_EXPLOIT"]
  for cve in cvssList:
    results.append(CVE(cve["Title"], cve["URL"]))
  
  return results
